!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var o=[];var r=function(e,t,n=""){let r;"object"==typeof e&&((t={...t,...e.options}).headers={...t.headers,...e.options.headers},e=e.url);try{r=fetch(e,t).then(e=>{if(!e.ok)return;let t=e.headers.get("content-type");switch(n.toLowerCase()){case"blob":return e.blob();case"text":return e.text();case"json":return e.json();default:return/text|html|rtf|xml/.test(t)?e.text():/json/.test(t)?e.json():e.blob()}}).catch(n=>{console.log("%c "+n,"color:red;"),o.push({url:e,options:t})})}catch{return}return r};var c=function(e,t){return new Promise((n,o)=>{setTimeout(()=>{n(e)},t)})};var a=(e,t={},n=3,o=0,a)=>{e=e.slice();let l=Math.ceil(e.length/n);return Array(l).fill(e=>(async([e,t,n],o,c)=>{let a=e.splice(0,o),l=await Promise.all(a.map(e=>r(e,t,c))),i=l.length;return l=l.filter(e=>e),console.log(`${l.length} 个已完成;${i-l.length} 错误`+(new Date).getTime()),n.push(l),[e,t,n]})(e,n,a)).reduce((e,t,n)=>e.then(t).then(e=>(console.log(100*n/l+" %完成"),e)).then(e=>c(e,o)),Promise.resolve([e,t,[]])).then(e=>e.pop())};var l=async function(e,t={},n,o=0,a=!1){let l=!0,i=[e,t],s=[];console.group("%c 请求组","color:green");for(let e=0;l;e++){let u=await r(i[0],{...t,...i[1]},a).then(t=>(console.log(`%c ${e} 完成`,"color:green;"),s.push(t),n(t,[e]))).then(e=>c(e,o));[l,i]=u}return console.groupEnd("%c 完成","color:green"),s};var i=async function({urls:e,time:t,options:n,type:o,limits:r,func:c,returnType:i}){switch(o){case"start":console.group("%c 并发请求","color:green");let o=await a(e,n,r,t,i);return console.groupEnd("%c 请求完成","color:green"),o.flat();case"pipe":console.group("%c 管道请求","color:green");let s=await l(e,n,c,t,i);return console.groupEnd("%c 请求完成","color:green"),s;default:console.group("%c 测试请求","color:green");let u=await a(e.slice(0,3),n,r,t,i);return console.groupEnd("%c 请求完成","color:green"),u}},s={};function u(){return document.cookie&&document.cookie.split(";").forEach(e=>{let[t,n]=e.split("=");n=unescape(decodeURI(n||"{}"));try{s[t.trim()]=JSON.parse(n)}catch(e){s[t.trim()]=n}}),!0}function p(e,t,n=1e3){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);let r=o.toUTCString();return document.cookie=`${e}=${t}; expires=${r}; path=/`,u(),!0}u();var d=new Proxy(s,{get:(e,t)=>(u(),e[t]),set(e,t,n){let o=n?p(t,n,1e3):p(t,"",-1);return u(),o}});var f=function(e){return new Promise(t=>{let n;if(/.js$/.test(e))n=document.createElement("script"),n.src=e;else{if(!/.css$/.test(e))throw new Error("请确认 URL 可以导入");n=document.createElement("link"),n.href=e,n.rel="stylesheet",n.type="text/css"}n.onload=()=>{console.log(e+"%c 载入成功","color:green"),t(!0)},n.onerror=()=>{console.log(e+"%c 载入失败","color:red"),t(!1)},document.body.appendChild(n)})};var m=async function(e){if(!window.JSZip){if(!await f("https://cdn.jsdelivr.net/npm/jszip@3.5.0/dist/jszip.min.js"))throw new Error("JSzip 加载失败")}let t=new JSZip;e.forEach(e=>{let n=e.name;t.file(n,e)});let n=await t.generateAsync({type:"blob"});return console.log("%c 压缩完成","color:green"),n};var g=function(e,t){return e.map((e,n)=>{let o=t[n];return e instanceof Blob?!o&&e.name||(e.name=o||n+".txt"):e=new File([JSON.stringify(e)||""],o||n+".txt"),e})};var h=function(e){return e.forEach(e=>{let t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=e.name,t.click(),t.remove(),console.log("%c 完成","color:green")}),!0};const y={get:(e,t)=>e[t],set:(e,t,n)=>(e[t]=n,e)};function w(e,t,n){let o=[...e.Func].reduce((e,n)=>n.apply(t,[e]),n),r=e.apply(t,o||n);return e.afterFunc.reduce((e,n)=>n.call(t,e),r)}async function b(e,t,n){let o=e.Func.reduce((e,n)=>e.then(e=>n.apply(t,[e])),Promise.resolve(n));return[e,...e.afterFunc].reduce((e,n)=>e.then(e=>n.call(t,e)),Promise.resolve(o||n))}var v=function(e,t=!1){e.Func=[],e.afterFunc=[];let n=y;return n.apply=t?b:w,new Proxy(e,n)};const E={get:function(e,t){if("length"===t&&e instanceof Array)return e[t];return e.GETTER.hasOwnProperty(t)?e.GETTER[t].apply(this,[e[t]]):e.GETTER.hasOwnProperty("DEFAULT")?e.GETTER.DEFAULT.apply(this,[t,e[t]]):e[t]},set:function(e,t,n){if("length"===t&&e instanceof Array)return e[t]=n,!0;if(("GETTER"===t||"SETTER"===t)&&"object"!=typeof n)return console.log("%c 请对对象属性赋值","color:red"),!1;if(e.SETTER.hasOwnProperty(t)){let o=e.SETTER[t].apply(this,[e[t],n]);return void 0!==o&&(e[t]=T(o)),!0}if(e.SETTER.hasOwnProperty("DEFAULT")){let o=e.SETTER.DEFAULT.apply(this,[e[t],n]);return void 0!==o&&(e[t]=T(o),!0)}return e[t]=n,!0}},S=(e,t)=>t;function T(e){let t=Object.prototype.toString.call(e).match(/(?<=\[object\s+)\S+?(?=\])/)[0];if("Object"!==t&&"Array"!==t||!e)return e;{Object.entries(e).forEach(([t,n])=>{e[t]=T(n)}),e.GETTER={DEFAULT:S},e.SETTER={DEFAULT:S};let t=new Proxy(e,E);return console.log("%c 代理对象完成","color:orange"),t}}var j=["parent","opener","top","length","frames","closed","location","self","window","document","name","customElements","history","locationbar","menubar","personalbar","scrollbars","statusbar","toolbar","status","frameElement","navigator","origin","external","screen","innerWidth","innerHeight","scrollX","pageXOffset","scrollY","pageYOffset","visualViewport","screenX","screenY","outerWidth","outerHeight","devicePixelRatio","clientInformation","screenLeft","screenTop","defaultStatus","defaultstatus","styleMedia","onsearch","isSecureContext","onabort","onblur","oncancel","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncontextmenu","oncuechange","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","onformdata","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseout","onmouseover","onmouseup","onmousewheel","onpause","onplay","onplaying","onprogress","onratechange","onreset","onresize","onscroll","onseeked","onseeking","onselect","onstalled","onsubmit","onsuspend","ontimeupdate","ontoggle","onvolumechange","onwaiting","onwebkitanimationend","onwebkitanimationiteration","onwebkitanimationstart","onwebkittransitionend","onwheel","onauxclick","ongotpointercapture","onlostpointercapture","onpointerdown","onpointermove","onpointerup","onpointercancel","onpointerover","onpointerout","onpointerenter","onpointerleave","onselectstart","onselectionchange","onanimationend","onanimationiteration","onanimationstart","ontransitionend","onafterprint","onbeforeprint","onbeforeunload","onhashchange","onlanguagechange","onmessage","onmessageerror","onoffline","ononline","onpagehide","onpageshow","onpopstate","onrejectionhandled","onstorage","onunhandledrejection","onunload","performance","stop","open","alert","confirm","prompt","print","queueMicrotask","requestAnimationFrame","cancelAnimationFrame","captureEvents","releaseEvents","requestIdleCallback","cancelIdleCallback","getComputedStyle","matchMedia","moveTo","moveBy","resizeTo","resizeBy","scroll","scrollTo","scrollBy","getSelection","find","webkitRequestAnimationFrame","webkitCancelAnimationFrame","fetch","btoa","atob","setTimeout","clearTimeout","setInterval","clearInterval","createImageBitmap","close","focus","blur","postMessage","onappinstalled","onbeforeinstallprompt","crypto","indexedDB","webkitStorageInfo","sessionStorage","localStorage","chrome","onpointerrawupdate","speechSynthesis","webkitRequestFileSystem","webkitResolveLocalFileSystemURL","openDatabase","applicationCache","caches","ondevicemotion","ondeviceorientation","ondeviceorientationabsolute"];var k=function e(t,n,o=5){return o--?t.reduce((t,r)=>{let[c,a]=r;if(n.test(c))return[...t,r];switch(Object.prototype.toString.call(a).match(/(?<=\[object\s+)\S+?(?=\])/)[0]){case"String":case"Function":case"Number":return n.test(a)?[...t,r]:t;case"Array":var l=e(Object.entries(a),n,o).reduce((e,t)=>{let n=parseInt(t[0])-e.length;return[...Array(n)].forEach(()=>e.push("***")),[...e,t[1]]},[]);return l.length?[...t,[c,l]]:t;case"Object":var i=Object.fromEntries(e(Object.entries(a),n,o));return 0===Object.keys(i).length?t:[...t,[c,i]];default:return t}},[]):(console.log("%c 触及低端不再下探","color:green"),[])};var x=!1;const O={Ajax:i,Cookies:d,Copy:{unCopyClear:function(){[document,...document.querySelectorAll("*")].forEach(e=>{e.oncontextmenu="",e.onselectstart=!0,e.oncopy="",e.oncut="";let t=window.getEventListeners(e);t.hasOwnProperty("copy")&&t.copy.forEach(t=>e.removeEventListener("copy",t.listener))}),console.log("清理完成")},copy:function(e,t=!1){t&&clearUnCopy();let n=e instanceof HTMLElement?e.outerHTML:JSON.stringify(e),o=document.createElement("div");o.innerText=n,document.body.appendChild(o),o.style.userSelect="text",getSelection().selectAllChildren(o),document.execCommand("copy"),o.remove(),console.log("%c 复制已经完成","color:green")}},Downloader:async function(e,t=[],n=!1){if(console.log("download启动"),(e=g(e,t)).length<10&&!n)h(e);else{console.log(n?"强制压缩":"%c 文件多于 10 个,启动压缩","color:orange");let t=await m(e);t.name=(new Date).toLocaleString()+".zip",h([t])}console.log("%c 下载完成","color:green")},...{hook:v,watch:T},...{HTMLParser:async function(e,t){return(await Promise.all(e.reduce((e,t)=>{if(t instanceof Blob){let n=t.text();e.push(n)}else"string"==typeof t&&e.push(t);return e},[]))).map(e=>{try{let n=e.match(/(?<=\<body[\s\S]*?>)[\s\S]+(?=<\/body>)/),o=n.length?n[0]:e,r=document.createElement("div");r.innerHTML=o;let c=t(r);return console.log("%c 解析完成","color:green"),r.remove(),c}catch(t){return e}})},XMLParser:async function(e){return window.parser||await f("https://cdn.bootcdn.net/ajax/libs/fast-xml-parser/3.17.1/parser.min.js"),e.map(e=>parser.parse(e))},TurnToMarkdown:async function(e){return window.turndownService||(await f("https://cdn.jsdelivr.net/npm/turndown/dist/turndown.min.js"),window.turndownService=new TurndownService({headingStyle:"atx",hr:"- - -",bulletListMarker:"*",codeBlockStyle:"fenced",fence:"```",emDelimiter:"*",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"collapsed"}),turndownService.addRule("strikethrough",{filter:["br"],replacement:function(){return"<br>"}})),e.map(e=>turndownService.turndown(e))}},Script:f,...{search:function(e,t,n=5){if(n<2&&console.log("深度不够"),!t instanceof RegExp&&t instanceof String&&(t=new RegExp(t)),e instanceof Object)return Object.fromEntries(k(Object.entries(e),t,n));throw new Error("不是对象，不能搜索")},Globals:function(){let e=Object.entries(window).filter(e=>!j.includes(e[0]));return Object.fromEntries(e)}},...{searchWindow:function(e,t){return(0,JSpider.prototype.search)((0,JSpider.prototype.Globals)(),e,t)},AjaxHook:async function(e,t="get"){let n=JSpider.prototype.hook;XMLHttpRequest.prototype.open=n(XMLHttpRequest.prototype.open),XMLHttpRequest.prototype.send=n(XMLHttpRequest.prototype.send),fetch=n(fetch),fetch.Func.push(t=>{let[n,o]=t;return console.log(n),e.test(n)&&console.log(n),t}),XMLHttpRequest.prototype.open.Func.push(n=>{let[o,r]=n;if(!/^http/.test(r)){let e=document.createElement("a");e.href=r,r=e.href}if(console.log("Ajax拦截 open",[r]),e.test(r)&&o.toLowerCase()===t){x=!0;try{let e=Object.fromEntries(r.split("?")[1].split("&").map(e=>e.split("=").map(e=>decodeURIComponent(e))));console.log(e)}catch(e){}}return n}),XMLHttpRequest.prototype.send.Func.push(e=>(x&&(x=!1),e))}},requestErr:o};window.JSpider=class{},Object.assign(JSpider.prototype,O)}]);