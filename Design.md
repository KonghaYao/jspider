# JSpider Design

_这是一个关于 JSpider 的结构设计文件_

## System 总体结构

**_下面的部分都称为 System，是 JSpider 流程中的一环，但是为了方便开发者使用，这些系统有可能不会被开发者看到，或者是以其他形式被开发者所使用。_**

### 1. Spider

**_Spider_** 是 JSpider 的爬虫流程工具，主要目的是爬取文件，负责如何爬取文件与数据。

职能：

1. **发送 Request ，接收 response**。

2. 对数据进行初步的 **格式转换**。

### 2. Data Processing

**_Data Processing_** 是 JSpider 中用于处理数据格式的各种数据

职能：

1.  实现各种各样的数据类型转换，如 JSON 转 xlsx Blob

2.  删减无用数据项。

### 3. Recorder

**_Recorder_** 是 JSpider 用来管理数据的方式，可以认为是 JSpider 和数据库的中间人，所有的数据通过 JSpider 中的 **_Recorder_** 来间接修改数据库中的数据。

职能：

1. 在传入数据的时候，进行相应的 **数据库的调度**。

2. 在需要的时候执行 **下载文件** 的功能。

### 4. Fake Server

**_Fake Server_** 是 JSpider 中的 ajax 拦截代理系统。

职能：

1. 通过制造 **虚假数据** 来迷惑前端的函数执行相应的步骤，

2. 创建一个 **虚拟服务器** 给前端的爬虫学习者提供相应的练习，这样就可以直接在网站上进行爬虫练习而不用后端服务器了。

### 5. Event Center

**_Event Center_** 是管理全局事件的 **system**。 用于同意管辖事件内容，方便进行 **JSpider** 事件的注册与销毁。

### 6. Task

**_Task_** 是 workflow 中封装的最小单位。也就是对数据封装一层，以便有可以调用的 API。

## Plugin 机制

**_所有的 System 都应该是和平台无关的，独立的；而 Plugin 是对接每一个平台实现具体功能的函数插件。_**

**_Plugin 机制_** 在 JSpider 中是对每一个 **System** 进行功能扩充的函数插件。

## 项目的代码结构

### 1. src 主要代码

### 2. package 文件夹下的分代码库

### 3. 代码格式化问题

1. 为了代码的可维护性更高，必须使用 **eslint + prettier** 的方式格式化所有的源代码，这样可以保证代码格式的统一。

2. **流程图统一使用 drawio** 进行源文件绘制。源文件可以通过 docsify 自动生成图片展示在文档中，所以不需要进行导出。

3. **流程图统一使用 英文统一字体** 编写注释或大段文字来保证美观，其他地方可以使用中文。

4. **代码模块化细分**，代码推荐通过 ESM 的 `import` 方式导入导出，但是**最好使用命名导出，而不是 default 导出**。

5. 项目使用 **_rollup_** 进行打包和产品生成。

6. 项目中使用 **docsify** 进行文档书写，而且文档文件全部放置在 docs 文件夹中，便于管理。
